

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Un Modelo BÃ¡sico de AMPL &#8212; Network Flow</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Class_2_Gurobi-AMPL/AMPL/2- Production-planning-basic';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../SyllabusFlujoEnRedes.html">
  
  
  
  
  
    <p class="title logo__title">Network Flow</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../SyllabusFlujoEnRedes.html">
                    Syllabus
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Semana 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Class_1_Introduction_Motivation/1-Introduction.html"><strong>Lectura 1: Flujo en redes</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Class_1_Introduction_Motivation/2-Project.html"><strong>Lectura 2: Proyecto del semestre</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Class_1_Introduction_Motivation/3-Graphs.html"><strong>Lectura 3: Grafos</strong></a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/tabarespozos/Network_Flow/blob/Network_Flow/Class_2_Gurobi-AMPL/AMPL/2- Production-planning-basic.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/tabarespozos/Network_Flow" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/tabarespozos/Network_Flow/issues/new?title=Issue%20on%20page%20%2FClass_2_Gurobi-AMPL/AMPL/2- Production-planning-basic.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Class_2_Gurobi-AMPL/AMPL/2- Production-planning-basic.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Un Modelo BÃ¡sico de AMPL</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#paso-preliminar-instalar-ampl-y-herramientas-de-python">Paso Preliminar: Instalar AMPL y herramientas de Python</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#paso-1-importar-ampl">Paso 1. Importar AMPL</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#paso-2-definir-variables">Paso 2. Definir Variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#paso-3-definir-la-funcion-objetivo">Paso 3. Definir la FunciÃ³n Objetivo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#paso-4-definir-las-restricciones">Paso 4. Definir las Restricciones</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#paso-5-resolver-el-problema">Paso 5: Resolver el problema</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#paso-6-reportando-la-solucion">Paso 6. Reportando la soluciÃ³n</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#accediendo-a-los-valores-de-la-solucion-con-display">Accediendo a los valores de la soluciÃ³n con <code class="docutils literal notranslate"><span class="pre">display</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#accediendo-a-los-valores-de-la-solucion-con-get-value">Accediendo a los valores de la soluciÃ³n con <code class="docutils literal notranslate"><span class="pre">get_value</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#crear-reportes-con-pandas-y-matplotlib">Crear reportes con Pandas y Matplotlib</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="un-modelo-basico-de-ampl">
<h1>Un Modelo BÃ¡sico de AMPL<a class="headerlink" href="#un-modelo-basico-de-ampl" title="Permalink to this heading">#</a></h1>
<p>AMPL es un lenguaje de modelado algebraico para la optimizaciÃ³n matemÃ¡tica que se integra con el entorno de programaciÃ³n Python. Permite a los usuarios definir modelos de optimizaciÃ³n que consisten en variables de decisiÃ³n, funciones objetivo y restricciones, y calcular soluciones utilizando una variedad de solvers de cÃ³digo abierto y comerciales.</p>
<p>Este cuaderno introduce los conceptos bÃ¡sicos de AMPL necesarios para formular y resolver el [problema de planificaciÃ³n de producciÃ³n] introducido en el cuaderno anterior:</p>
<ul class="simple">
<li><p>Variables</p></li>
<li><p>Objetivos</p></li>
<li><p>Restricciones</p></li>
<li><p>ResoluciÃ³n</p></li>
<li><p>Reporte de la soluciÃ³n</p></li>
</ul>
<p>El modelo de AMPL mostrado en este cuaderno es una traducciÃ³n directa del modelo matemÃ¡tico en componentes bÃ¡sicos de AMPL. En este enfoque, los valores de los parÃ¡metros del modelo matemÃ¡tico se incluyen directamente en el modelo de AMPL para mayor simplicidad.</p>
<section id="paso-preliminar-instalar-ampl-y-herramientas-de-python">
<h2>Paso Preliminar: Instalar AMPL y herramientas de Python<a class="headerlink" href="#paso-preliminar-instalar-ampl-y-herramientas-de-python" title="Permalink to this heading">#</a></h2>
<p>Comenzamos instalando amplpy, la interfaz de programaciÃ³n de aplicaciones (o API) que integra el lenguaje de modelado AMPL con el lenguaje de programaciÃ³n Python. TambiÃ©n instalamos dos utilidades de Python, matplotlib y pandas, que se utilizarÃ¡n en las partes de este cuaderno que muestran resultados.</p>
<p>Estas instalaciones deben realizarse solo una vez para cada entorno de Python en una computadora personal. Sin embargo, se debe realizar una nueva instalaciÃ³n para cada nueva sesiÃ³n de Colab.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># instalar dependencias</span>
<span class="o">%</span><span class="k">pip</span> install -q amplpy matplotlib pandas
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install solver modules (e.g., HiGHS, CBC, Gurobi)</span>
<span class="c1"># amplpy.modules install highs cbc gurobi</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import and instantiate AMPL object in Python:</span>

<span class="kn">from</span> <span class="nn">amplpy</span> <span class="kn">import</span> <span class="n">AMPL</span><span class="p">,</span> <span class="n">ampl_notebook</span>

<span class="n">ampl</span> <span class="o">=</span> <span class="n">ampl_notebook</span><span class="p">(</span>
    <span class="n">modules</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cbc&quot;</span><span class="p">,</span> <span class="s2">&quot;highs&quot;</span><span class="p">],</span>  <span class="c1"># modules to install</span>
    <span class="n">license_uuid</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span>  <span class="c1"># license to use</span>
<span class="p">)</span>  <span class="c1"># instantiate AMPL object and register magics</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "81709b04aeaf4691944fe3123251c980", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="paso-1-importar-ampl">
<h2>Paso 1. Importar AMPL<a class="headerlink" href="#paso-1-importar-ampl" title="Permalink to this heading">#</a></h2>
<p>El primer paso para un nuevo modelo de AMPL es importar los componentes necesarios en el entorno de AMPL. El cÃ³digo de Python que se muestra a continuaciÃ³n se utiliza al comienzo de cada cuaderno. Hay solo dos elementos que pueden variar segÃºn sus necesidades:</p>
<ul class="simple">
<li><p>La lista de <code class="docutils literal notranslate"><span class="pre">modules</span></code> importa las herramientas necesarias. En nuestro caso, necesitamos solo amplpy.</p></li>
<li><p>El nombre del solver. Amplpy admite varios solvers disponibles, pero debe configurarse para utilizar uno de ellos.</p></li>
</ul>
</section>
<section id="paso-2-definir-variables">
<h2>Paso 2. Definir Variables<a class="headerlink" href="#paso-2-definir-variables" title="Permalink to this heading">#</a></h2>
<p>El siguiente paso es definir las variables del modelo. Esto incluye tanto las variables de decisiÃ³n como las variables auxiliares utilizadas para cÃ¡lculos intermedios.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">ampl_eval</span>
# define decision variables

reset;

var xM &gt;= 0;
var xA &gt;= 0, &lt;= 80;
var xB &gt;= 0, &lt;= 100;

var yU &gt;= 0, &lt;= 40;
var yV &gt;= 0;
</pre></div>
</div>
</div>
</div>
</section>
<section id="paso-3-definir-la-funcion-objetivo">
<h2>Paso 3. Definir la FunciÃ³n Objetivo<a class="headerlink" href="#paso-3-definir-la-funcion-objetivo" title="Permalink to this heading">#</a></h2>
<p>El objetivo del modelo es maximizar las ganancias. Esto se logra definiendo la funciÃ³n objetivo como la diferencia entre los ingresos y los costos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">ampl_eval</span>
# define objective function

maximize Profit:
   270*yU + 210*yV - 10*xM - 50*xA - 40*xB;
</pre></div>
</div>
</div>
</div>
</section>
<section id="paso-4-definir-las-restricciones">
<h2>Paso 4. Definir las Restricciones<a class="headerlink" href="#paso-4-definir-las-restricciones" title="Permalink to this heading">#</a></h2>
<p>Las restricciones se derivan de los recursos disponibles y los requisitos de los productos. Las restricciones se pueden escribir como:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">ampl_eval</span>
# define constraints

subj to raw_materials: 10*yU + 9*yV &lt;= xM;
subj to labor_A: 2*yU + 1*yV &lt;= xA;
subj to labor_B: 1*yU + 1*yV &lt;= xB;
</pre></div>
</div>
</div>
</div>
<section id="paso-5-resolver-el-problema">
<h3>Paso 5: Resolver el problema<a class="headerlink" href="#paso-5-resolver-el-problema" title="Permalink to this heading">#</a></h3>
<p>Con el modelo completamente especificado, el siguiente paso es calcular los valores Ã³ptimos para las variables de decisiÃ³n. Para esto, usaremos comandos y llamadas a funciones de <code class="docutils literal notranslate"><span class="pre">amplpy</span></code> que gestionan la integraciÃ³n de AMPL y Python.</p>
<p>Para calcular una soluciÃ³n Ã³ptima, llamamos a un <strong>solver</strong>: un programa separado que aplica algoritmos numÃ©ricos para determinar valores Ã³ptimos para las variables. Los pasos son los siguientes:</p>
<ol class="arabic simple">
<li><p><strong>Mostrar y expandir los componentes del modelo</strong>:</p>
<ul class="simple">
<li><p>Utiliza los comandos <code class="docutils literal notranslate"><span class="pre">show</span></code> y <code class="docutils literal notranslate"><span class="pre">expand</span></code> en AMPL para verificar que todo ha sido especificado correctamente.</p></li>
<li><p>Usa la funciÃ³n <code class="docutils literal notranslate"><span class="pre">eval</span></code> de <code class="docutils literal notranslate"><span class="pre">amplpy.AMPL</span></code> para ejecutar estos comandos en AMPL desde Python.</p></li>
</ul>
</li>
<li><p><strong>Configurar el solver</strong>:</p>
<ul class="simple">
<li><p>La opciÃ³n <code class="docutils literal notranslate"><span class="pre">solver</span></code> de <code class="docutils literal notranslate"><span class="pre">amplpy.AMPL</span></code> se establece en uno de los solvers que cargamos en el paso 2.</p></li>
</ul>
</li>
<li><p><strong>Invocar el solver</strong>:</p>
<ul class="simple">
<li><p>La funciÃ³n <code class="docutils literal notranslate"><span class="pre">solve</span></code> de <code class="docutils literal notranslate"><span class="pre">amplpy.AMPL</span></code> invoca el solver elegido. AMPL se encarga de convertir el modelo a la forma que el solver necesita para su cÃ¡lculo, y convierte los resultados a un formato que puede ser usado en Python.</p></li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># exhibit the model that has been built</span>
<span class="n">ampl</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s2">&quot;show;&quot;</span><span class="p">)</span>
<span class="n">ampl</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s2">&quot;expand;&quot;</span><span class="p">)</span>

<span class="c1"># solve using two different solvers</span>
<span class="n">ampl</span><span class="o">.</span><span class="n">option</span><span class="p">[</span><span class="s2">&quot;solver&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;cbc&quot;</span>
<span class="n">ampl</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<span class="n">ampl</span><span class="o">.</span><span class="n">option</span><span class="p">[</span><span class="s2">&quot;solver&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;highs&quot;</span>
<span class="n">ampl</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>variables:   xA   xB   xM   yU   yV

constraints:   labor_A   labor_B   raw_materials

objective:   Profit
maximize Profit:
	-10*xM - 50*xA - 40*xB + 270*yU + 210*yV;

subject to raw_materials:
	-xM + 10*yU + 9*yV &lt;= 0;

subject to labor_A:
	-xA + 2*yU + yV &lt;= 0;

subject to labor_B:
	-xB + yU + yV &lt;= 0;

cbc 2.10.10:cbc 2.10.10: optimal solution; objective 2400
0 simplex iterations
HiGHS 1.7.0:HiGHS 1.7.0: optimal solution; objective 2400
0 simplex iterations
0 barrier iterations
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="paso-6-reportando-la-solucion">
<h2>Paso 6. Reportando la soluciÃ³n<a class="headerlink" href="#paso-6-reportando-la-solucion" title="Permalink to this heading">#</a></h2>
<p>El paso final en la mayorÃ­a de las aplicaciones es reportar la soluciÃ³n en un formato adecuado. Para este ejemplo, demostramos informes simples en formato tabular y grÃ¡fico utilizando la biblioteca Pandas.</p>
<section id="accediendo-a-los-valores-de-la-solucion-con-display">
<h3>Accediendo a los valores de la soluciÃ³n con <code class="docutils literal notranslate"><span class="pre">display</span></code><a class="headerlink" href="#accediendo-a-los-valores-de-la-solucion-con-display" title="Permalink to this heading">#</a></h3>
<p>La funciÃ³n <code class="docutils literal notranslate"><span class="pre">ampl.display</span></code> de <code class="docutils literal notranslate"><span class="pre">amplpy</span></code> muestra los valores de una o mÃ¡s expresiones de AMPL, calculados a partir de los valores actuales de las variables. TambiÃ©n puedes aplicar esta funciÃ³n a expresiones especiales como <code class="docutils literal notranslate"><span class="pre">_var</span></code> para los valores de todas las variables y <code class="docutils literal notranslate"><span class="pre">_varname</span></code> para los nombres de todas las variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># display a component of the model</span>
<span class="n">ampl</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="s2">&quot;Profit&quot;</span><span class="p">)</span>
<span class="n">ampl</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="s2">&quot;270*yU + 210*yV&quot;</span><span class="p">,</span> <span class="s2">&quot;10*xM + 50*xA + 40*xB&quot;</span><span class="p">)</span>

<span class="n">ampl</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="s2">&quot;_varname&quot;</span><span class="p">,</span> <span class="s2">&quot;_var&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Profit = 2400

270*yU + 210*yV = 16800
10*xM + 50*xA + 40*xB = 14400

: _varname  _var    :=
1   xM       720
2   xA        80
3   xB        80
4   yU         0
5   yV        80
;
</pre></div>
</div>
</div>
</div>
</section>
<section id="accediendo-a-los-valores-de-la-solucion-con-get-value">
<h3>Accediendo a los valores de la soluciÃ³n con <code class="docutils literal notranslate"><span class="pre">get_value</span></code><a class="headerlink" href="#accediendo-a-los-valores-de-la-solucion-con-get-value" title="Permalink to this heading">#</a></h3>
<p>DespuÃ©s de que una soluciÃ³n Ã³ptima ha sido calculada exitosamente, el valor de una expresiÃ³n de AMPL puede ser recuperado en Python usando la funciÃ³n <code class="docutils literal notranslate"><span class="pre">ampl.get_value</span></code>. Cuando se combina con las cadenas <code class="docutils literal notranslate"><span class="pre">f</span></code> de Python, <code class="docutils literal notranslate"><span class="pre">ampl.get_value</span></code> proporciona un medio conveniente para crear informes formateados.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Profit = </span><span class="si">{</span><span class="n">ampl</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="s1">&#39;Profit&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2"> 9.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Revenue = </span><span class="si">{</span><span class="n">ampl</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="s1">&#39;270*yU + 210*yV&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2"> 9.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Cost = </span><span class="si">{</span><span class="n">ampl</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="s1">&#39;10*xM + 50*xA + 40*xB&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2"> 9.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Profit =   2400.00
Revenue =  16800.00
   Cost =  14400.00
</pre></div>
</div>
</div>
</div>
</section>
<section id="crear-reportes-con-pandas-y-matplotlib">
<h3>Crear reportes con Pandas y Matplotlib<a class="headerlink" href="#crear-reportes-con-pandas-y-matplotlib" title="Permalink to this heading">#</a></h3>
<p>Pandas, una biblioteca de cÃ³digo abierto para trabajar con datos en Python, es ampliamente utilizada en la comunidad de ciencia de datos. AquÃ­ utilizamos un objeto <code class="docutils literal notranslate"><span class="pre">Series()</span></code> de Pandas para mantener y mostrar datos de la soluciÃ³n. Luego podemos visualizar los datos utilizando la biblioteca matplotlib, por ejemplo, con un grÃ¡fico de barras.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># create pandas series for production and raw materials</span>
<span class="n">production</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;U&quot;</span><span class="p">:</span> <span class="n">ampl</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="s2">&quot;yU&quot;</span><span class="p">),</span>
        <span class="s2">&quot;V&quot;</span><span class="p">:</span> <span class="n">ampl</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="s2">&quot;yV&quot;</span><span class="p">),</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">raw_materials</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="n">ampl</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="s2">&quot;xA&quot;</span><span class="p">),</span>
        <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="n">ampl</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="s2">&quot;xB&quot;</span><span class="p">),</span>
        <span class="s2">&quot;M&quot;</span><span class="p">:</span> <span class="n">ampl</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="s2">&quot;xM&quot;</span><span class="p">),</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="c1"># display pandas series</span>
<span class="n">display</span><span class="p">(</span><span class="n">production</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">raw_materials</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>U     0
V    80
dtype: int64
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A     80
B     80
M    720
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># create grid of subplots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="c1"># show pandas series as horizontal bar plots</span>
<span class="n">production</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;barh&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Production&quot;</span><span class="p">)</span>
<span class="n">raw_materials</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;barh&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Raw Materials&quot;</span><span class="p">)</span>

<span class="c1"># show vertical axis in descending order</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b3e9ae78b7cc64771351755aaa5ffa9734e4faa5b24a5fe3bd11baf72d1b70c3.png" src="../../_images/b3e9ae78b7cc64771351755aaa5ffa9734e4faa5b24a5fe3bd11baf72d1b70c3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> production_planning_basic.mod

<span class="c1"># decision variables</span>
<span class="n">var</span> <span class="n">x_M</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">var</span> <span class="n">x_A</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&lt;=</span> <span class="mi">80</span><span class="p">;</span>
<span class="n">var</span> <span class="n">x_B</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&lt;=</span> <span class="mi">100</span><span class="p">;</span>

<span class="n">var</span> <span class="n">y_U</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&lt;=</span> <span class="mi">40</span><span class="p">;</span>
<span class="n">var</span> <span class="n">y_V</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span>

<span class="c1"># auxiliary variables</span>
<span class="n">var</span> <span class="n">revenue</span> <span class="o">=</span> <span class="mi">270</span> <span class="o">*</span> <span class="n">y_U</span> <span class="o">+</span> <span class="mi">210</span> <span class="o">*</span> <span class="n">y_V</span><span class="p">;</span>
<span class="n">var</span> <span class="n">cost</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">x_M</span> <span class="o">+</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">x_A</span> <span class="o">+</span> <span class="mi">40</span> <span class="o">*</span> <span class="n">x_B</span><span class="p">;</span>

<span class="c1"># objective</span>
<span class="n">maximize</span> <span class="n">profit</span><span class="p">:</span> <span class="n">revenue</span> <span class="o">-</span> <span class="n">cost</span><span class="p">;</span>

<span class="c1"># constraints</span>
<span class="n">s</span><span class="o">.</span><span class="n">t</span><span class="o">.</span> <span class="n">raw_materials</span><span class="p">:</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">y_U</span> <span class="o">+</span> <span class="mi">9</span> <span class="o">*</span> <span class="n">y_V</span> <span class="o">&lt;=</span> <span class="n">x_M</span><span class="p">;</span>
<span class="n">s</span><span class="o">.</span><span class="n">t</span><span class="o">.</span> <span class="n">labor_A</span><span class="p">:</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y_U</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">y_V</span> <span class="o">&lt;=</span> <span class="n">x_A</span><span class="p">;</span>
<span class="n">s</span><span class="o">.</span><span class="n">t</span><span class="o">.</span> <span class="n">labor_B</span><span class="p">:</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">y_U</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">y_V</span> <span class="o">&lt;=</span> <span class="n">x_B</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing production_planning_basic.mod
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create AMPL instance and load the model</span>
<span class="n">ampl</span> <span class="o">=</span> <span class="n">AMPL</span><span class="p">()</span>
<span class="n">ampl</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;production_planning_basic.mod&quot;</span><span class="p">)</span>

<span class="c1"># Select a solver and solve the problem</span>
<span class="n">ampl</span><span class="o">.</span><span class="n">option</span><span class="p">[</span><span class="s2">&quot;solver&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;cbc&quot;</span>
<span class="n">ampl</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cbc 2.10.10:cbc 2.10.10: optimal solution; objective 2400
0 simplex iterations
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Class_2_Gurobi-AMPL\AMPL"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#paso-preliminar-instalar-ampl-y-herramientas-de-python">Paso Preliminar: Instalar AMPL y herramientas de Python</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#paso-1-importar-ampl">Paso 1. Importar AMPL</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#paso-2-definir-variables">Paso 2. Definir Variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#paso-3-definir-la-funcion-objetivo">Paso 3. Definir la FunciÃ³n Objetivo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#paso-4-definir-las-restricciones">Paso 4. Definir las Restricciones</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#paso-5-resolver-el-problema">Paso 5: Resolver el problema</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#paso-6-reportando-la-solucion">Paso 6. Reportando la soluciÃ³n</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#accediendo-a-los-valores-de-la-solucion-con-display">Accediendo a los valores de la soluciÃ³n con <code class="docutils literal notranslate"><span class="pre">display</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#accediendo-a-los-valores-de-la-solucion-con-get-value">Accediendo a los valores de la soluciÃ³n con <code class="docutils literal notranslate"><span class="pre">get_value</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#crear-reportes-con-pandas-y-matplotlib">Crear reportes con Pandas y Matplotlib</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Alejandra Tabares
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      Â© Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>